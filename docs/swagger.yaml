swagger: "2.0"
info:
  title: User API
  description: User authentication and profile management API
  version: "1.0.0"
  contact:
    name: API Support

host: localhost:8080
basePath: /
schemes:
  - http
  - https

consumes:
  - application/json
produces:
  - application/json

securityDefinitions:
  Bearer:
    type: apiKey
    name: Authorization
    in: header
    description: JWT Authorization header (Bearer token)

paths:
  /login:
    post:
      summary: User Login
      description: Authenticate user with email and password
      operationId: userLogin
      tags:
        - Authentication
      parameters:
        - in: body
          name: body
          description: User login credentials
          required: true
          schema:
            $ref: "#/definitions/LoginRequest"
      responses:
        200:
          description: Login successful
          schema:
            $ref: "#/definitions/LoginResponse"
        400:
          description: Validation failed
          schema:
            $ref: "#/definitions/ValidationErrorResponse"
        401:
          description: Invalid email or password
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error
          schema:
            $ref: "#/definitions/ErrorResponse"

  /api/profile:
    get:
      summary: Get User Profile
      description: Retrieve authenticated user's profile information
      operationId: getUserProfile
      tags:
        - Profile
      security:
        - Bearer: []
      responses:
        200:
          description: User profile retrieved successfully
          schema:
            $ref: "#/definitions/UserProfile"
        401:
          description: Unauthorized access
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error
          schema:
            $ref: "#/definitions/ErrorResponse"

  /api/profile/{userId}:
    get:
      summary: Get Specific User Profile
      description: Retrieve profile information for a specific user
      operationId: getSpecificUserProfile
      tags:
        - Profile
      security:
        - Bearer: []
      parameters:
        - in: path
          name: userId
          description: ID of the user to retrieve
          required: true
          type: integer
      responses:
        200:
          description: User profile retrieved successfully
          schema:
            $ref: "#/definitions/UserProfile"
        400:
          description: Invalid user ID
          schema:
            $ref: "#/definitions/ErrorResponse"
        401:
          description: Unauthorized access
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error
          schema:
            $ref: "#/definitions/ErrorResponse"

  /api/teams:
    get:
      summary: List Teams
      description: Retrieve a list of teams with pagination
      operationId: listTeams
      tags:
        - Teams
      security:
        - Bearer: []
      parameters:
        - in: query
          name: limit
          description: Number of teams to retrieve (max 100)
          required: false
          type: integer
          default: 10
          minimum: 1
          maximum: 100
        - in: query
          name: offset
          description: Number of teams to skip for pagination
          required: false
          type: integer
          default: 0
          minimum: 0
      responses:
        200:
          description: Teams retrieved successfully
          schema:
            $ref: "#/definitions/ListTeamsResponse"
        400:
          description: Validation failed
          schema:
            $ref: "#/definitions/ValidationErrorResponse"
        401:
          description: Unauthorized access
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error
          schema:
            $ref: "#/definitions/ErrorResponse"

  /api/teams/{id}:
    get:
      summary: Get Team Details
      description: Retrieve detailed information about a specific team
      operationId: getTeamDetails
      tags:
        - Teams
      security:
        - Bearer: []
      parameters:
        - in: path
          name: id
          description: ID of the team to retrieve
          required: true
          type: integer
      responses:
        200:
          description: Team details retrieved successfully
          schema:
            $ref: "#/definitions/TeamDetail"
        400:
          description: Invalid team ID
          schema:
            $ref: "#/definitions/ErrorResponse"
        401:
          description: Unauthorized access
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error
          schema:
            $ref: "#/definitions/ErrorResponse"

  /api/teams/{id}/members:
    get:
      summary: List Team Members
      description: Retrieve a paginated list of members in a specific team
      operationId: listTeamMembers
      tags:
        - Teams
      security:
        - Bearer: []
      parameters:
        - in: path
          name: id
          description: ID of the team
          required: true
          type: integer
        - in: query
          name: limit
          description: Number of members to retrieve (max 100)
          required: false
          type: integer
          default: 10
          minimum: 1
          maximum: 100
        - in: query
          name: offset
          description: Number of members to skip for pagination
          required: false
          type: integer
          default: 0
          minimum: 0
      responses:
        200:
          description: Team members retrieved successfully
          schema:
            $ref: "#/definitions/ListTeamMembersResponse"
        400:
          description: Validation failed
          schema:
            $ref: "#/definitions/ValidationErrorResponse"
        401:
          description: Unauthorized access
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error
          schema:
            $ref: "#/definitions/ErrorResponse"

  /api/notifications:
    get:
      summary: List Notifications
      description: Retrieve a list of notifications for the authenticated user
      operationId: listNotifications
      tags:
        - Notifications
      security:
        - Bearer: []
      parameters:
        - in: query
          name: limit
          description: Number of notifications to retrieve (max 100)
          required: false
          type: integer
          default: 10
          minimum: 1
          maximum: 100
        - in: query
          name: offset
          description: Number of notifications to skip for pagination
          required: false
          type: integer
          default: 0
          minimum: 0
      responses:
        200:
          description: Notifications retrieved successfully
          schema:
            $ref: "#/definitions/NotificationListResponse"
        401:
          description: Unauthorized access
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error
          schema:
            $ref: "#/definitions/ErrorResponse"

  /api/notifications/unread-count:
    get:
      summary: Get Unread Notifications Count
      description: Get the number of unread notifications for the authenticated user
      operationId: getUnreadCount
      tags:
        - Notifications
      security:
        - Bearer: []
      responses:
        200:
          description: Unread count retrieved successfully
          schema:
            $ref: "#/definitions/UnreadCountResponse"
        401:
          description: Unauthorized access
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error
          schema:
            $ref: "#/definitions/ErrorResponse"

  /api/notifications/{id}/read:
    put:
      summary: Mark Notification as Read
      description: Mark a specific notification as read
      operationId: markAsRead
      tags:
        - Notifications
      security:
        - Bearer: []
      parameters:
        - in: path
          name: id
          description: ID of the notification
          required: true
          type: integer
      responses:
        200:
          description: Notification marked as read successfully
          schema:
            $ref: "#/definitions/MessageResponse"
        400:
          description: Invalid notification ID
          schema:
            $ref: "#/definitions/ErrorResponse"
        401:
          description: Unauthorized access
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error
          schema:
            $ref: "#/definitions/ErrorResponse"

  /api/notifications/read-all:
    put:
      summary: Mark All Notifications as Read
      description: Mark all notifications for the authenticated user as read
      operationId: markAllAsRead
      tags:
        - Notifications
      security:
        - Bearer: []
      responses:
        200:
          description: All notifications marked as read successfully
          schema:
            $ref: "#/definitions/MessageResponse"
        401:
          description: Unauthorized access
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error
          schema:
            $ref: "#/definitions/ErrorResponse"

  /api/notifications/{id}:
    delete:
      summary: Delete Notification
      description: Delete a specific notification
      operationId: deleteNotification
      tags:
        - Notifications
      security:
        - Bearer: []
      parameters:
        - in: path
          name: id
          description: ID of the notification
          required: true
          type: integer
      responses:
        200:
          description: Notification deleted successfully
          schema:
            $ref: "#/definitions/MessageResponse"
        400:
          description: Invalid notification ID
          schema:
            $ref: "#/definitions/ErrorResponse"
        401:
          description: Unauthorized access
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error
          schema:
            $ref: "#/definitions/ErrorResponse"

definitions:
  LoginRequest:
    type: object
    required:
      - user
    properties:
      user:
        type: object
        required:
          - email
          - password
        properties:
          email:
            type: string
            format: email
            example: "user@example.com"
          password:
            type: string
            format: password
            example: "password123"

  LoginResponse:
    type: object
    properties:
      user:
        type: object
        properties:
          id:
            type: integer
            format: uint
            example: 1
          name:
            type: string
            example: "John Doe"
          email:
            type: string
            format: email
            example: "user@example.com"
          access_token:
            type: string
            example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

  UserProfile:
    type: object
    properties:
      id:
        type: integer
        format: uint
        example: 1
      name:
        type: string
        example: "John Doe"
      email:
        type: string
        format: email
        example: "user@example.com"
      birthday:
        type: string
        format: date
        example: "1990-01-15"
      current_team:
        $ref: "#/definitions/TeamSummary"
      position:
        $ref: "#/definitions/Position"
      projects:
        type: array
        items:
          $ref: "#/definitions/ProjectSummary"
      skills:
        type: array
        items:
          $ref: "#/definitions/UserSkillSummary"

  TeamSummary:
    type: object
    properties:
      id:
        type: integer
        format: uint
        example: 1
      name:
        type: string
        example: "Backend Team"

  Position:
    type: object
    properties:
      id:
        type: integer
        format: uint
        example: 1
      name:
        type: string
        example: "Senior Developer"
      abbreviation:
        type: string
        example: "SD"

  ProjectSummary:
    type: object
    properties:
      id:
        type: integer
        format: uint
        example: 1
      name:
        type: string
        example: "Project Alpha"
      abbreviation:
        type: string
        example: "PA"
      start_date:
        type: string
        format: date-time
        example: "2024-01-01T00:00:00Z"
      end_date:
        type: string
        format: date-time
        example: "2024-12-31T00:00:00Z"

  UserSkillSummary:
    type: object
    properties:
      id:
        type: integer
        format: uint
        example: 1
      name:
        type: string
        example: "Go Programming"
      level:
        type: integer
        example: 4
      used_year_number:
        type: integer
        example: 3

  ListTeamsResponse:
    type: object
    properties:
      teams:
        type: array
        items:
          $ref: "#/definitions/TeamDetail"
      page:
        $ref: "#/definitions/PaginationResponse"

  ListTeamMembersResponse:
    type: object
    properties:
      members:
        type: array
        items:
          $ref: "#/definitions/TeamMemberSummary"
      page:
        $ref: "#/definitions/PaginationResponse"

  TeamMemberSummary:
    type: object
    properties:
      id:
        type: integer
        format: uint
        example: 1
      name:
        type: string
        example: "John Doe"
      email:
        type: string
        format: email
        example: "user@example.com"
      joined_at:
        type: string
        format: date-time
        example: "2024-01-01T00:00:00Z"

  TeamDetail:
    type: object
    properties:
      id:
        type: integer
        format: uint
        example: 1
      name:
        type: string
        example: "Backend Team"
      description:
        type: string
        example: "Team responsible for backend development"
      created_at:
        type: string
        format: date-time
        example: "2024-01-01T00:00:00Z"
      updated_at:
        type: string
        format: date-time
        example: "2024-01-15T00:00:00Z"
      leader:
        $ref: "#/definitions/UserSummary"
      members:
        type: array
        items:
          $ref: "#/definitions/UserSummary"
      projects:
        type: array
        items:
          $ref: "#/definitions/ProjectSummary"

  PaginationResponse:
    type: object
    properties:
      limit:
        type: integer
        example: 10
      offset:
        type: integer
        example: 0
      total:
        type: integer
        example: 25

  UserSummary:
    type: object
    properties:
      id:
        type: integer
        format: uint
        example: 1
      name:
        type: string
        example: "John Doe"

  ErrorResponse:
    type: object
    properties:
      code:
        type: integer
        example: 500
      message:
        type: string
        example: "Error message describing the issue"

  ValidationErrorResponse:
    type: object
    properties:
      code:
        type: integer
        example: 400
      message:
        type: string
        example: "Validation failed"
      details:
        type: object
        description: "Field-specific validation errors"
        example:
          email: "must be a valid email"
          password: "is required"

  NotificationResponse:
    type: object
    properties:
      id:
        type: integer
        format: uint
        example: 1
      user_id:
        type: integer
        format: uint
        example: 1
      title:
        type: string
        example: "New Message"
      content:
        type: string
        example: "You have a new message from John Doe"
      is_read:
        type: boolean
        example: false
      created_at:
        type: string
        format: date-time
        example: "2024-01-01T00:00:00Z"

  NotificationListResponse:
    type: object
    properties:
      notifications:
        type: array
        items:
          $ref: "#/definitions/NotificationResponse"
      total:
        type: integer
        example: 100

  UnreadCountResponse:
    type: object
    properties:
      unread_count:
        type: integer
        example: 5

  MessageResponse:
    type: object
    properties:
      message:
        type: string
        example: "Success message"
