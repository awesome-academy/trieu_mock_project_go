{{define "pages/admin_user_detail.html"}}
<!DOCTYPE html>
<html lang="en">
  <head>
    {{template "partials/admin_head.html" .}}
  </head>
  <body>
    {{template "partials/admin_navbar.html" .}}

    <div class="container mt-4">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="/admin">Admin</a></li>
          <li class="breadcrumb-item"><a href="/admin/users">Users</a></li>
          <li class="breadcrumb-item active" aria-current="page">
            {{.user.Name}}
          </li>
        </ol>
      </nav>

      {{if .error}}
      <div class="alert alert-danger" role="alert">{{.error}}</div>
      <a href="/admin/users" class="btn btn-secondary">Back to Users</a>
      {{else}}
      <div class="row">
        <div class="col-lg-4">
          <!-- Profile Card -->
          <div class="card mb-4 shadow-sm">
            <div class="card-body text-center">
              <div class="mb-3">
                <i class="bi bi-person-circle display-1 text-secondary"></i>
              </div>
              <h3 class="card-title fw-bold">{{.user.Name}}</h3>
              <p class="text-muted mb-1">
                {{.user.Position.Name}} ({{.user.Position.Abbreviation}})
              </p>
              <p class="text-muted small mb-4">
                {{if .user.CurrentTeam}}
                <span class="badge bg-info text-dark"
                  >Team: {{.user.CurrentTeam.Name}}</span
                >
                {{else}}
                <span class="badge bg-secondary">No Team</span>
                {{end}}
              </p>
              <div class="d-grid gap-2">
                <a
                  href="/admin/users/{{.user.ID}}/edit"
                  class="btn btn-outline-primary"
                >
                  Edit Profile
                </a>
                <button
                  class="btn btn-outline-danger"
                  type="button"
                  id="deleteUserBtn"
                  data-user-id="{{.user.ID}}"
                  data-user-name="{{.user.Name}}"
                >
                  Delete User
                </button>
              </div>
            </div>
          </div>

          <!-- Skills Card -->
          <div class="card mb-4 shadow-sm">
            <div class="card-header bg-white fw-bold">
              <i class="bi bi-star-fill text-warning me-2"></i>Skills
            </div>
            <div class="card-body">
              {{if .user.Skills}}
              <div class="d-flex flex-wrap gap-2">
                {{range .user.Skills}}
                <span class="badge bg-light text-dark border">{{.Name}}</span>
                {{end}}
              </div>
              {{else}}
              <p class="text-muted mb-0">No skills listed.</p>
              {{end}}
            </div>
          </div>
        </div>

        <div class="col-lg-8">
          <!-- Basic Information -->
          <div class="card mb-4 shadow-sm">
            <div class="card-header bg-white fw-bold">
              <i class="bi bi-info-circle-fill text-primary me-2"></i>Basic
              Information
            </div>
            <div class="card-body">
              <div class="row mb-3">
                <div class="col-sm-3 fw-bold">Full Name</div>
                <div class="col-sm-9 text-secondary">{{.user.Name}}</div>
              </div>
              <hr />
              <div class="row mb-3">
                <div class="col-sm-3 fw-bold">Email</div>
                <div class="col-sm-9 text-secondary">{{.user.Email}}</div>
              </div>
              <hr />
              <div class="row mb-3">
                <div class="col-sm-3 fw-bold">Birthday</div>
                <div class="col-sm-9 text-secondary">
                  {{if .user.Birthday}} {{.user.Birthday.Format "2006-01-02"}}
                  {{else}} N/A {{end}}
                </div>
              </div>
            </div>
          </div>

          <!-- Projects -->
          <div class="card mb-4 shadow-sm">
            <div class="card-header bg-white fw-bold">
              <i class="bi bi-briefcase-fill text-success me-2"></i>Projects
            </div>
            <div class="card-body">
              {{if .user.Projects}}
              <div class="table-responsive">
                <table class="table table-hover align-middle">
                  <thead class="table-light">
                    <tr>
                      <th>Project Name</th>
                      <th>Abbr.</th>
                      <th>Start Date</th>
                      <th>End Date</th>
                    </tr>
                  </thead>
                  <tbody>
                    {{range .user.Projects}}
                    <tr>
                      <td class="fw-bold">{{.Name}}</td>
                      <td>
                        <span class="badge bg-secondary"
                          >{{.Abbreviation}}</span
                        >
                      </td>
                      <td>
                        {{if .StartDate}}{{.StartDate.Format
                        "2006-01-02"}}{{else}}-{{end}}
                      </td>
                      <td>
                        {{if .EndDate}}{{.EndDate.Format
                        "2006-01-02"}}{{else}}Present{{end}}
                      </td>
                    </tr>
                    {{end}}
                  </tbody>
                </table>
              </div>
              {{else}}
              <p class="text-muted mb-0">No projects assigned.</p>
              {{end}}
            </div>
          </div>
        </div>
      </div>
      {{end}}
    </div>

    {{template "partials/admin_scripts.html" .}}
    <script src="/static/js/services/admin_user_service.js"></script>
    <script src="/static/js/admin_user_detail.js"></script>
  </body>
</html>
{{end}}
